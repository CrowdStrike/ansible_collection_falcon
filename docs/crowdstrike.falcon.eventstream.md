# crowdstrike.falcon.eventstream

An ansible-rulebook event source plugin for generating events from the Falcon Event Stream API.

## Synopsis

- This event source can be used to automate responses to events generated by the CrowdStrike Falcon platform.

## Requirements

- Python 3.6+
- Python requirements are listed in [requirements.txt](./requirements.txt)
- Ensure the following API scopes are enabled:
  - **Event Streams**: [read]

## Parameters

| Parameter | Comments |
| --- | --- |
| **falcon_client_id**</br><font color=purple>string</font> / <font color=red>required</font> | CrowdStrike OAUTH Client ID |
| **falcon_client_secret**</br><font color=purple>string</font> / <font color=red>required</font> | CrowdStrike OAUTH Client Secret |
| **falcon_cloud**</br><font color=purple>string</font> / <font color=red>required</font> | CrowdStrike Cloud Region</br>**Choices**:</br>us-1</br>us-2</br>eu-1</br>us-gov-1</br><font color=blue>**Default:** us-1</font> |
| **stream_name**</br><font color=purple>string</font> | Label that identifies your connection.</br>**Max:** 32 alphanumeric characters (a-z, A-Z, 0-9)</br><font color=blue>**Default:** eda</font> |
| **include_event_types**</br><font color=purple>list</font> | List of event types to include. Otherwise all event types are included.</br>Refer to the [Streaming API Event Dictionary](https://falcon.crowdstrike.com/documentation/62/streaming-api-event-dictionary).</br><font color=blue>**Default:** None.</font> |
| **exclude_event_types**</br><font color=purple>list</font> | List of event types to exclude.</br>Refer to the [Streaming API Event Dictionary](https://falcon.crowdstrike.com/documentation/62/streaming-api-event-dictionary).</br><font color=blue>**Default:** None.</font> |
| **offset**</br><font color=purple>int</font> | Specifies where in the event stream you want to being processing. This is useful if you have a mechanism to track the latest offset processed.</br>*This option is mutually exclusive with* `latest`. </br><font color=blue>**Default:** None.</font> |
| **latest**</br><font color=purple>bool</font> | Start the stream from the latest event. By default, if `offset` is not set, the stream will start from the beginning of all events.</br>*This option is mutually exclusive with* `offset`.</br><font color=blue>**Default:** false.</font> |
| **delay**</br><font color=purple>float</font> | Introduce a delay between each event.</br><font color=blue>**Default:** 0.</font> |

## Example Rulebook

```yaml
---
- name: Simple Falcon Event Stream Usage Example
  hosts: all
  sources:
    - crowdstrike.falcon.eventstream:
        falcon_client_id: "{{ FALCON_CLIENT_ID }}"
        falcon_client_secret: "{{ FALCON_CLIENT_SECRET }}"
        falcon_cloud: "us-2"
        # start stream from specified offset
        offset: 12345
        stream_name: "eda-example"
        include_event_types:
          - "DetectionSummaryEvent"

  rules:
    - name: Print High and Critical Severity Detection Events
      condition: event.falcon.event.Severity > 3
      action:
        debug:
```

## Authors

- Carlos Matos (@carlosmmatos)
- Frank Falor (@ffalor)
